<!DOCTYPE html>
<html><head>
<title>Linear Regression</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">












<script defer data-domain="alphacoder.xyz" src="https://analytics.terna.io/js/plausible.js"></script>


<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">


  




<link rel="icon" href="https://alphacoder.xyz/images/alpha-coder-logo-v1-small.png">



<link rel="stylesheet" href="https://alphacoder.xyz/scss/journal.min.e3bbe8a4e9def42361d46a08558b2ceeb666c944d881cbcfa75a3435be6afa74.css" integrity="sha256-47vopOne9CNh1GoIVYss7rZmyUTYgcvPp1o0Nb5q&#43;nQ=" media="screen">



<link rel="stylesheet" href="https://alphacoder.xyz/scss/dark-mode.min.16749f4d04ce998e04ecf1c45f01d051b413e9693378f8834e15973538e1d735.css" integrity="sha256-FnSfTQTOmY4E7PHEXwHQUbQT6WkzePiDThWXNTjh1zU=" media="screen">


<script src="/vendor/js/loadCSS.js"></script>
<script>
  loadCSS("https://fonts.googleapis.com/css?family=Lora|Montserrat|Fira+Mono|Noto+Serif+SC|Material+Icons|Exo+2");
</script>






  <script src="/js/toc.js"></script>







<script src="https://cdn.jsdelivr.net/npm/vue-disqus@3/dist/vue-disqus.js"></script>








</head>
<body>
    	<div id="app"><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://alphacoder.xyz/">
    
        <div class="nav-title">
            Alpha Coder
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/blog/">
                Blog
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tag/side-projects/">
                Side Projects
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="https://www.youtube.com/@alphacoderblog">
                Videos
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags/">
                Tags
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
<a href="https://twitter.com/AlphaCoderXYZ">
    Twitter
</a>
<br>

<a href="mailto:support@alphacoder.xyz">
    Email
</a>
<br>

<a href="/blog/index.xml">
    RSS
</a>
<br>


        &copy;
    
    Copyright 2017 to ∞. Nicholas Kajoh. All rights reserved.
    

    </div>
    
</div><div id="extraContainer" class="extra-container">
    
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- OUTLINE -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#the-ml-chops-series" onclick="onNavClick(`#the-ml-chops-series-nav`)" id="the-ml-chops-series-nav">
									The ML Chops series
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#machine-learning" onclick="onNavClick(`#machine-learning-nav`)" id="machine-learning-nav">
									Machine Learning
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#linear-regression-lr" onclick="onNavClick(`#linear-regression-lr-nav`)" id="linear-regression-lr-nav">
									Linear Regression (LR)
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#best-fitline" onclick="onNavClick(`#best-fitline-nav`)" id="best-fitline-nav">
									Best fit line
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#equation-of-aline" onclick="onNavClick(`#equation-of-aline-nav`)" id="equation-of-aline-nav">
									Equation of a line
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#slope" onclick="onNavClick(`#slope-nav`)" id="slope-nav">
									Slope
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#intercept" onclick="onNavClick(`#intercept-nav`)" id="intercept-nav">
									Intercept
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#simple-example" onclick="onNavClick(`#simple-example-nav`)" id="simple-example-nav">
									Simple example
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#predict" onclick="onNavClick(`#predict-nav`)" id="predict-nav">
									Predict
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#model-accuracy" onclick="onNavClick(`#model-accuracy-nav`)" id="model-accuracy-nav">
									Model accuracy
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>
<div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/blog/">
                    Blog
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tag/side-projects/">
                    Side Projects
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="https://www.youtube.com/@alphacoderblog">
                    Videos
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags/">
                    Tags
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- OUTLINE -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#the-ml-chops-series" onclick="onNavClick(`#the-ml-chops-series-nav`)" id="the-ml-chops-series-nav">
									The ML Chops series
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#machine-learning" onclick="onNavClick(`#machine-learning-nav`)" id="machine-learning-nav">
									Machine Learning
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#linear-regression-lr" onclick="onNavClick(`#linear-regression-lr-nav`)" id="linear-regression-lr-nav">
									Linear Regression (LR)
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#best-fitline" onclick="onNavClick(`#best-fitline-nav`)" id="best-fitline-nav">
									Best fit line
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#equation-of-aline" onclick="onNavClick(`#equation-of-aline-nav`)" id="equation-of-aline-nav">
									Equation of a line
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#slope" onclick="onNavClick(`#slope-nav`)" id="slope-nav">
									Slope
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#intercept" onclick="onNavClick(`#intercept-nav`)" id="intercept-nav">
									Intercept
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#simple-example" onclick="onNavClick(`#simple-example-nav`)" id="simple-example-nav">
									Simple example
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#predict" onclick="onNavClick(`#predict-nav`)" id="predict-nav">
									Predict
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#model-accuracy" onclick="onNavClick(`#model-accuracy-nav`)" id="model-accuracy-nav">
									Model accuracy
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://alphacoder.xyz/">
            Alpha Coder
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://alphacoder.xyz/">
        <div class="single-column-header-title">Alpha Coder</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title" v-pre>
                    Linear Regression
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2017-12-04
                        </time>
                        

                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tag/ml-chops-series">ML Chops Series</a>
                                &nbsp;
                            
                                <a href="/tag/machine-learning">Machine Learning</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <p>What better way to learn than to do? I decided to implement from scratch some Machine Learning algorithms I’m learning as a way to better understand and internalize them. The algorithms include Linear Regression, K Nearest Neighbors, Support Vector Machine, Naive Bayes, K Means and Neural Networks.</p>
<p><img src="/images/linear-regression/ml-meme.jpeg" alt=""></p>
<p><strong>ML Chops</strong> is a series meant to explain the inner workings of these algorithms so you can get a pretty good grasp of how they work as well as know how to implement them yourself. We’ll be using the Python programming language.</p>
<p>There’s a repo on my GitHub where all the code can be found. The url is: <a href="https://github.com/nicholaskajoh/ML_Chops">https://github.com/nicholaskajoh/ML_Chops</a>.</p>
<h1 id="the-ml-chops-series">The ML Chops series</h1>
<ul>
<li>Linear Regression (this article)</li>
<li><a href="/k-nearest-neighbors">K Nearest Neighbors</a></li>
<li><a href="/naive-bayes">Naive Bayes</a></li>
<li><a href="/support-vector-machine">Support Vector Machine</a></li>
<li><a href="/k-means">K Means</a></li>
</ul>
<h1 id="machine-learning">Machine Learning</h1>
<p>I’m assuming the term Machine Learning is not strange to you. You may not really know how to implement or use Machine Learning algorithms, but you probably have some intuition about how it all works. You essentially “train” an algorithm/a model with data and then it’s able to make predictions, a lot of times very accurately.</p>
<p>If all this sounds like Mandarin, you should probably watch Josh Gordon’s explanation of what Machine Learning is.</p>
<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/cKxRvEZd3Mw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>If you’re good at this point, then let’s talk Linear Regression.</p>
<h1 id="linear-regression-lr">Linear Regression (LR)</h1>
<p>Linear Regression is a simple model for predicting <a href="https://www.mathsisfun.com/definitions/continuous-data.html">continuous data</a>/real-valued outputs. It’s commonly used in subjects like physics, chemistry and math. I first came across it in secondary school practical physics when I had to predict outputs using data recorded during experiments. Sound familiar? 🙄</p>
<p>Imagine you want to predict the price per barrel of crude oil in Nigeria for tomorrow, next week or next month. With data on the prices over the years or past months, you can make a fairly accurate forecast of what the price would be using LR. Keep in mind that we’re assuming the data is correlated (positively or negatively). If it’s not correlated, then LR is probably not a good fit. We’ll talk about other algorithms that can handle nonlinear data later on in the series. For now we need to use linear data else, our predictions would be really really bad. We don’t want bad! 😒</p>
<p>The graph below may help you visualize linear data better…</p>
<p><img src="/images/linear-regression/graph-of-linear-data.png" alt=""></p>
<p><em>Graph of linear data</em></p>
<p>The first thing you probably noticed is how somewhat scattered the data points are. There’s a pattern though, and it’s linear. As the value on the horizontal axis increases, the value on the vertical axis [generally] increases as well (positive correlation).</p>
<h1 id="best-fitline">Best fit line</h1>
<p>There’s a green line that passes through some of the points on the graph. It’s called the <strong>line of best fit</strong>. Ideally this line should pass through all the points. However there is some “error” in the data. This explains why there is some scatteredness in the plot.</p>
<p>The line of best fit is the best possible line you can draw to fit the data. If the data had no errors, this line would pass through every point in the graph. The real world is not that perfect though. There’s always some degree of error. For instance, the price of crude oil generally increases year after year but not by a constant amount. It may increase $3 this year and $1 next year. As a result, we can’t know for sure how much it would cost in the near future, but we can make predictions given the best fit line. But how do we get the best fit line?</p>
<h1 id="equation-of-aline">Equation of a line</h1>
<p>Recall the equation of a straight line? It’s <code>y = mx + c</code>. The best fit line is a straight line so we can use this equation to figure it out.</p>
<p><em>x</em> is the independent variable. In the case of the crude oil example, it’s a year (e.g 2001, 2002, 2003, …, 2010 etc).</p>
<p><em>y</em> is the dependent variable. This is the value we want to predict. Given the prices of oil from 2001 to 2010, we may want to predict the price in 2011, 2012 or even 2018.</p>
<p><em>m</em> is the slope of the line. It’s a number that measures its “steepness”. In other words, it is the change in <em>y</em> for a unit change in <em>x</em> along the line.</p>
<p><em>c</em> is the y intercept. That is, the point where the line crosses the vertical/y-axis.</p>
<p>We know <em>x</em>. We want to find <em>y</em>. We just need to figure out what <em>m</em> and <em>c</em> is for the best fit line (of a given data set) to be able to make predictions… 🤔</p>
<p>It turns out that there are formulas from which we can evaluate the slope, <em>m</em> and y intercept, <em>c.</em> Once we get the slope and y intercept, our model is ready!</p>
<p>Mathematically, our LR model may look like this: <code>y = 2.1x + 1.4</code> where m = 2.1 and c = 1.4</p>
<h1 id="slope">Slope</h1>
<p><img src="/images/linear-regression/slope.png" alt=""></p>
<p><em>slope formula</em></p>
<p><strong>NB:</strong> the <em>bar</em> symbol represents <strong>mean/average</strong>. E.g “X bar” is the mean of the Xs in the dataset.</p>
<h1 id="intercept">Intercept</h1>
<p><img src="/images/linear-regression/intercept.png" alt=""></p>
<p><em>y intercept formula</em></p>
<h1 id="simple-example">Simple example</h1>
<p>Say we have the years 2001, 2002, 2003, &hellip;, 2010 and oil prices 43.1, 45.2, 43.7, 49.0, 50.5, 53.7, 53.0, 56.8, 57.2, 60.0. We could come up with a table like so:</p>
<pre><code>x (yrs)   1    2    3    4    5    6    7    8    9    10

y (in $)  43.1 45.2 43.7 49.0 50.5 53.7 53.0 56.8 57.2 60.0
</code></pre>
<p>I used 1 to 10 to represent 2001 to 2010 so that calculations would be easier to comprehend. It doesn’t affect anything. You can use the years to do your calculation if that resonates with you. Keep in mind though that the difference of any two consecutive values of x must be 1.</p>
<p>Using code, we can calculate the slope and intercept like so:</p>
<pre><code>import numpy as np  
from statistics import mean

xs = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])  
ys = np.array([43.1, 45.2, 43.7, 49.0, 50.5, 53.7, 53.0, 56.8, 57.2, 60.0])

m = ((mean(xs) * mean(ys)) - mean(xs * ys)) / (mean(xs)**2 - mean(xs * xs))

c = mean(ys) - (m * mean(xs))
</code></pre>
<h1 id="predict">Predict</h1>
<p>If we want to predict how much oil would cost in 2018, all we need to do is supply <em>x</em> in our model. <em>x</em> would be 18. Thus:</p>
<pre><code>x = 18  
y = m * x + c  
print(y)
</code></pre>
<h1 id="model-accuracy">Model accuracy</h1>
<p>Accuracy is very important to Machine Learning developers. Our LR model makes predictions. It’s of interest to us to know how accurate these predictions are. While 80% accuracy of a model that predicts the price of oil for me sounds good enough, it’s probably a deal breaker for my client who buys and sells oil. He’s probably looking for somewhere around 95 to 99.9%. 80% is too much risk!</p>
<p>There are several ways to calculate how accurate a LR model is. We’re going to talk about one of them called R-squared. It’s a statistical measure of how close the data are to the fitted regression line/best fit line. It is also known as the coefficient of determination. With R-squared, we’re simply asking: <em>how good is the best fit line?</em></p>
<p>Of course, if the best fit line is not good enough, then it’s the data to blame (it’s the best fit line duh 😜). Regardless, it means the predictions made using the line would be less accurate.</p>
<p>R-squared is given by the formula:</p>
<p><img src="/images/linear-regression/r-squared.png" alt=""></p>
<p><em>r squared</em></p>
<p>SS stands for <em>Sum of Squared error of</em></p>
<p>y hat line (y with the caret) is the <em>ys of the best fit line ( for each x)</em></p>
<p>y bar is the <em>mean of the ys</em></p>
<p>To calculate the R-squared for a given model:</p>
<pre><code>best_fit_line = [(m * x) + c for x in xs]

SSy_hat = sum([y * y for y in (best_fit_line - ys)]) # y hat line  
SSy_mean = sum([y * y for y in [y - mean(ys) for y in ys]]) # mean of ys

r2 = 1 - (SSy_hat / SSy_mean)
</code></pre>
<p>The range of r2 is usually 0 to 1 so you can multiply it by 100 to get a percentage.</p>
<p>Don’t forget to check out the repo for the complete Linear Regression code: <a href="https://github.com/nicholaskajoh/ML_Chops/tree/master/linear-regression">https://github.com/nicholaskajoh/ML_Chops/tree/master/linear-regression</a>.</p>
<p>If you have any questions, concerns or suggestions, don’t hesitate to comment! 👍</p>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">Last modified on 2023-03-14</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="https://alphacoder.xyz/k-nearest-neighbors/">
			Next<br>K Nearest Neighbors
                </a>
                
                
                
                <a class="older-posts" href="https://alphacoder.xyz/responsive-grid-system/">
			Previous<br>A responsive grid system with few lines of CSS
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                
<div id="disqus_thread"></div>
<script>
    

    var disqus_config = function () {
        
        this.page.url = 'https:\/\/alphacoder.xyz\/linear-regression\/';  
        
        
        this.page.identifier = 'https:\/\/alphacoder.xyz\/linear-regression\/'; 
    };
    (function() {
        var d = document, s = d.createElement('script');
        s.src = 'https://alphacoderxyz.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow"> comments powered by Disqus.  </a> </noscript>











            </div>
        </div>
    </div>


                    </div>
            </div><div id="single-column-footer">&copy;
    
    Copyright 2017 to ∞. Nicholas Kajoh. All rights reserved.
    
</div>
            </div>
    
    <script src="/js/journal.js"></script>
    </body>
</html>
