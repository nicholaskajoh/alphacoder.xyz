<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Linear Regression | Alpha Coder</title>

    <link rel="shortcut icon" type="image/png" href="/images/alpha-coder-logo-v1-small.png"/>

    <link href="https://fonts.googleapis.com/css?family=Merriweather" rel="stylesheet">
    
    <style>body{margin:40px auto;max-width:650px;line-height:1.6;font-family:merriweather,serif;font-size:16px;color:#444;padding:0 10px}h1,h2,h3{line-height:1.2}div.header h1{padding-top:0;padding-bottom:8px;margin-bottom:24px;font-size:15px;font-weight:400;border-bottom:1px solid}.header-menu{float:right}.header-menu a{padding-left:5px}ul.pagination{list-style-type:none;text-align:center;padding:0}ul.pagination>li{padding:0 8px;display:inline-block}div.footer{border-top:1px solid;text-align:center}.footer-links a{padding:0 5px}img{max-width:100%;max-height:100%;display:block;margin-left:auto;margin-right:auto}a,a:visited,a:hover,a:active{color:#00e}.posts-list li:not(:last-child){padding-bottom:20px}.post-meta a:not(:last-child){padding-right:5px}blockquote{margin-top:10px;margin-bottom:10px;margin-left:50px;padding-left:15px;border-left:3px solid #ccc;background-color:#f9f9f9;font-style:italic}</style>

    

    
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-82728104-5', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    

    

    <meta property="og:title" content="Linear Regression" />
<meta property="og:description" content="What better way to learn than to do? I decided to implement from scratch some Machine Learning algorithms I‚Äôm learning as a way to better understand and internalize them. The algorithms include Linear Regression, K Nearest Neighbors, Support Vector Machine, Naive Bayes, K Means and Neural Networks.
ML Chops is a series meant to explain the inner workings of these algorithms so you can get a pretty good grasp of how they work as well as know how to implement them yourself." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://alphacoder.xyz/linear-regression/" />
<meta property="article:published_time" content="2017-12-04T08:44:05+01:00" />
<meta property="article:modified_time" content="2017-12-04T08:44:05+01:00" />

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Linear Regression"/>
<meta name="twitter:description" content="What better way to learn than to do? I decided to implement from scratch some Machine Learning algorithms I‚Äôm learning as a way to better understand and internalize them. The algorithms include Linear Regression, K Nearest Neighbors, Support Vector Machine, Naive Bayes, K Means and Neural Networks.
ML Chops is a series meant to explain the inner workings of these algorithms so you can get a pretty good grasp of how they work as well as know how to implement them yourself."/>

    <meta itemprop="name" content="Linear Regression">
<meta itemprop="description" content="What better way to learn than to do? I decided to implement from scratch some Machine Learning algorithms I‚Äôm learning as a way to better understand and internalize them. The algorithms include Linear Regression, K Nearest Neighbors, Support Vector Machine, Naive Bayes, K Means and Neural Networks.
ML Chops is a series meant to explain the inner workings of these algorithms so you can get a pretty good grasp of how they work as well as know how to implement them yourself.">
<meta itemprop="datePublished" content="2017-12-04T08:44:05&#43;01:00" />
<meta itemprop="dateModified" content="2017-12-04T08:44:05&#43;01:00" />
<meta itemprop="wordCount" content="1369">



<meta itemprop="keywords" content="ML Chops Series," />
    
    <script type="text/javascript">
        window._mNHandle = window._mNHandle || {};
        window._mNHandle.queue = window._mNHandle.queue || [];
        medianet_versionId = "3121199";
    </script>
    <script src="https://contextual.media.net/dmedianet.js?cid=8CUBJ5TUP" async="async"></script>
</head>


<body>
<div class="header">
    <h1>
        <a href="/">Alpha Coder</a>
        <div class="header-menu">
            <a href="/blog/">Blog</a>
            <a href="https://courses.alphacoder.xyz">Courses</a>
            <a href="https://community.alphacoder.xyz">Community</a>
        </div>
    </h1>
</div>
<div id="content">

<header>
    <h1>Linear Regression</h1>
    

<div class="post-meta">
    <time datetime="2017-12-04">Dec 4, 2017</time>
    | Tags:
    <a href="http://alphacoder.xyz/tag/ml-chops-series/">ML Chops Series</a>
</div>
</header>
<article>
    <p>What better way to learn than to do? I decided to implement from scratch some Machine Learning algorithms I‚Äôm learning as a way to better understand and internalize them. The algorithms include Linear Regression, K Nearest Neighbors, Support Vector Machine, Naive Bayes, K Means and Neural Networks.</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*otatqOkzhxFl4LXtkbDmhQ.jpeg" alt=""></p>
<p><strong>ML Chops</strong> is a series meant to explain the inner workings of these algorithms so you can get a pretty good grasp of how they work as well as know how to implement them yourself. We‚Äôll be using the Python programming language.</p>
<p>There‚Äôs a repo on my GitHub where all the code can be found. The url is: <a href="https://github.com/nicholaskajoh/ML_Chops">https://github.com/nicholaskajoh/ML_Chops</a>.</p>
<h1 id="the-ml-chops-series">The ML Chops series</h1>
<ul>
<li>Linear Regression (this article)</li>
<li><a href="/k-nearest-neighbors">K Nearest Neighbors</a></li>
<li><a href="/naive-bayes">Naive Bayes</a></li>
<li><a href="/support-vector-machine">Support Vector Machine</a></li>
<li><a href="/k-means">K Means</a></li>
</ul>
<h1 id="machine-learning">Machine Learning</h1>
<p>I‚Äôm assuming Machine Learning is not strange-ish to you. You may not really know how to implement or use Machine Learning algorithms, but you probably have some intuition about how it all works. You essentially ‚Äútrain‚Äù an algorithm/a model with data and then it‚Äôs able to make predictions, a lot of times very accurately.</p>
<p>If all this sounds Mandarin, you should probably watch Josh Gordon‚Äôs explanation of what Machine Learning is.</p>
<!-- raw HTML omitted -->
<p>If you‚Äôre good at this point, then let‚Äôs talk Linear Regression.</p>
<h1 id="linear-regression-lr">Linear Regression (LR)</h1>
<p>Linear Regression is a simple model for predicting <a href="https://www.mathsisfun.com/definitions/continuous-data.html">continuous data</a>/real-valued outputs. It‚Äôs commonly used in subjects like physics, chemistry and math. I first came across it in secondary school practical physics when I had to predict outputs using data recorded during experiments. Sound familiar? üôÑ</p>
<p>Imagine you want to predict the price per barrel of crude oil in Nigeria for tomorrow, next week or next month. With data on the prices over the years or past months, you can make a fairly accurate forecast of what the price would be using LR. Keep in mind that we‚Äôre assuming the data is correlated (positively or negatively). If it‚Äôs not correlated, then LR is probably not a good fit. We‚Äôll talk about other algorithms that can handle nonlinear data later on in the series. For now we need to use linear data else, our predictions would be really really bad. We don‚Äôt want bad! üòí</p>
<p>The graph below may help you visualize linear data better‚Ä¶</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*iC2R89E_DBY5fSuQApTwhg.png" alt="">
<em>Graph of linear¬†data</em></p>
<p>The first thing you probably noticed is how somewhat scattered the data points are. There‚Äôs a pattern though, and it‚Äôs linear. As the value on the horizontal axis increases, the value on the vertical axis [generally] increases as well (positive correlation).</p>
<h1 id="best-fitline">Best fit¬†line</h1>
<p>There‚Äôs a green line that passes through some of the points on the graph. It‚Äôs called the <strong>line of best fit</strong>. Ideally this line should pass through all the points. However there is some ‚Äúerror‚Äù in the data. This explains why there is some scatteredness in the plot.</p>
<p>The line of best fit is the best possible line you can draw to fit the data. If the data had no errors, this line would pass through every point in the graph. The real world is not that perfect though. There‚Äôs always some degree of error. For instance, the price of crude oil generally increases year after year but not by a constant amount. It may increase $3 this year and $1 next year. As a result, we can‚Äôt know for sure how much it would cost in the near future, but we can make predictions given the best fit line. But how do we get the best fit line?</p>
<h1 id="equation-of-aline">Equation of a¬†line</h1>
<p>Recall the equation of a straight line? It‚Äôs <code>y = mx + c</code>. The best fit line is a straight line so we can use this equation to figure it out.</p>
<p><em>x</em> is the independent variable. In the case of the crude oil example, it‚Äôs a year (e.g 2001, 2002, 2003,¬†‚Ä¶, 2010 etc).</p>
<p><em>y</em> is the dependent variable. This is the value we want to predict. Given the prices of oil from 2001 to 2010, we may want to predict the price in 2011, 2012 or even 2018.</p>
<p><em>m</em> is the slope of the line. It‚Äôs a number that measures its ‚Äústeepness‚Äù. In other words, it is the change in <em>y</em> for a unit change in <em>x</em> along the line.</p>
<p><em>c</em> is the y intercept. That is, the point where the line crosses the vertical/y-axis.</p>
<p>We know <em>x</em>. We want to find <em>y</em>. We just need to figure out what <em>m</em> and <em>c</em> is for the best fit line (of a given data set) to be able to make predictions‚Ä¶ ü§î</p>
<p>It turns out that there are formulas from which we can evaluate the slope, <em>m</em> and y intercept, <em>c.</em> Once we get the slope and y intercept, our model is ready!</p>
<p>Mathematically, our LR model may look like this: <code>y = 2.1x + 1.4</code> where m = 2.1 and c = 1.4</p>
<h1 id="slope">Slope</h1>
<p><img src="https://cdn-images-1.medium.com/max/800/1*vji1X_3xW3lZsXUY4Vf-cg.png" alt="">
<em>slope formula</em></p>
<p><strong>NB:</strong> the <em>bar</em> symbol represents <strong>mean/average</strong>. E.g ‚ÄúX bar‚Äù is the mean of the Xs in the dataset.</p>
<h1 id="intercept">Intercept</h1>
<p><img src="https://cdn-images-1.medium.com/max/800/1*MtVs1yxkMyl2MpK2Wystbg.png" alt="">
<em>y intercept formula</em></p>
<h1 id="simple-example">Simple example</h1>
<p>Say we have the years 2001, 2002, 2003,¬†&hellip;, 2010 and oil prices 43.1, 45.2, 43.7, 49.0, 50.5, 53.7, 53.0, 56.8, 57.2, 60.0. We could come up with a table like so:</p>
<pre><code>x (yrs)   1    2    3    4    5    6    7    8    9    10

y (in $)  43.1 45.2 43.7 49.0 50.5 53.7 53.0 56.8 57.2 60.0
</code></pre>
<p>I used 1 to 10 to represent 2001 to 2010 so that calculations would be easier to comprehend. It doesn‚Äôt affect anything. You can use the years to do your calculation if that resonates with you. Keep in mind though that the difference of any two consecutive values of x must be 1.</p>
<p>Using code, we can calculate the slope and intercept like so:</p>
<pre><code>import numpy as np  
from statistics import mean

xs = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])  
ys = np.array([43.1, 45.2, 43.7, 49.0, 50.5, 53.7, 53.0, 56.8, 57.2, 60.0])

m = ((mean(xs) * mean(ys)) - mean(xs * ys)) / (mean(xs)**2 - mean(xs * xs))

c = mean(ys) - (m * mean(xs))
</code></pre>
<h1 id="predict">Predict</h1>
<p>If we want to predict how much oil would cost in 2018, all we need to do is supply <em>x</em> in our model. <em>x</em> would be 18. Thus:</p>
<pre><code>x = 18  
y = m * x + c  
print(y)
</code></pre>
<h1 id="model-accuracy">Model accuracy</h1>
<p>Accuracy is very important to Machine Learning developers. Our LR model makes predictions. It‚Äôs of interest to us to know how accurate these predictions are. While 80% accuracy of a model that predicts the price of oil for me sounds good enough, it‚Äôs probably a deal breaker for my client who buys and sells oil. He‚Äôs probably looking for somewhere around 95 to 99.9%. 80% is too much risk!</p>
<p>There are several ways to calculate how accurate a LR model is. We‚Äôre going to talk about one of them called R-squared. It‚Äôs a statistical measure of how close the data are to the fitted regression line/best fit line. It is also known as the coefficient of determination. With R-squared, we‚Äôre simply asking: <em>how good is the best fit line?</em></p>
<p>Of course, if the best fit line is not good enough, then it‚Äôs the data to blame (it‚Äôs the best fit line duh üòú). Regardless, it means the predictions made using the line would be less accurate.</p>
<p>R-squared is given by the formula:</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*HTeayn8hGYQzICFcYc3OdA.png" alt="">
<em>r squared</em></p>
<p>SS stands for <em>Sum of Squared error of</em></p>
<p>y hat line (y with the caret) is the <em>ys of the best fit line ( for each x)</em></p>
<p>y bar is the <em>mean of the ys</em></p>
<p>To calculate the R-squared for a given model:</p>
<pre><code>best_fit_line = [(m * x) + c for x in xs]

SSy_hat = sum([y * y for y in (best_fit_line - ys)]) # y hat line  
SSy_mean = sum([y * y for y in [y - mean(ys) for y in ys]]) # mean of ys

r2 = 1 - (SSy_hat / SSy_mean)
</code></pre>
<p>The range of r2 is usually 0 to 1 so you can multiply it by 100 to get a percentage.</p>
<p>Don‚Äôt forget to check out the repo for the complete Linear Regression code: <a href="https://github.com/nicholaskajoh/ML_Chops/tree/master/linear-regression">https://github.com/nicholaskajoh/ML_Chops/tree/master/linear-regression</a>.</p>
<p>If you have any questions, concerns or suggestions, don‚Äôt hesitate to comment! üëç</p>

</article>




<form
  style="border: 1px solid #ccc; text-align: center; border-radius: 2px; margin: 15px 0;"
  action="https://tinyletter.com/nicholaskajoh"
  method="post"
  target="popupwindow" onsubmit="window.open('https://tinyletter.com/nicholaskajoh', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true">
    <div style="padding: 20px;">
      <h2 style="margin-top: 0;">Subscribe to the Alpha Coder Newsletter!</h2>

      <p>Get timely updates on new articles, courses and more from Nicholas Kajoh. Unsubscribe anytime.</p>
      
      <input
        type="text"
        style="width: 150px; height: 30px; padding-left: 5px; border: 1px solid #ccc; border-radius: 2px;"
        name="email"
        placeholder="night.king@westeros.org">
      <input type="hidden" value="1" name="embed">
      <input
        type="submit"
        style="height: 34px; color: #fff; background-color: #00e; border: 1px solid #00e; border-radius: 2px;"
        value="Subscribe">
    </div>
</form>




  
  
    <p>
      Previous post: <a href="http://alphacoder.xyz/responsive-grid-system/"><strong>A responsive grid system with few lines of CSS</strong></a>
    </p>
  

  
    <p>
      Next post: <a href="http://alphacoder.xyz/k-nearest-neighbors/"><strong>K Nearest Neighbors</strong></a>
    </p>
  
  



  <br><div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "alphacoderxyz" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



    </div>
<div class="footer">
    
    
    <div class="footer-links">
        <a href="/musings/">Musings</a>
        <a href="https://twitter.com/AlphaCoderXYZ">Twitter</a>
        <a href="https://www.linkedin.com/company/alphacoder">LinkedIn</a>
        <a href="mailto:support@alphacoder.xyz">Email</a>
        
        <a href="/blog/index.xml">RSS</a>
    </div>
    

    
    
    <div class="copyright">¬© Copyright 2020 to ‚àû. Try Catch Finally Solutions Ltd. All rights reserved.</div>
    
</div>


<script src="https://unpkg.com/medium-zoom@1.0.4/dist/medium-zoom.min.js"></script>
<script>
  mediumZoom(document.querySelectorAll('img'));
</script></body>

</html>