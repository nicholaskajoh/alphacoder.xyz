<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Deploy your React-Django app on Heroku | Alpha Coder</title>

    <style>body{margin:40px auto;max-width:650px;line-height:1.6;font-size:18px;color:#444;padding:0 10px}h1,h2,h3{line-height:1.2}div.header h1{padding-top:0;padding-bottom:8px;margin-bottom:24px;font-size:18px;font-weight:400;border-bottom:1px solid}.header-menu{float:right}ul.pagination{list-style-type:none;text-align:center;padding:0}ul.pagination>li{padding:0 8px;display:inline-block}div.footer{border-top:1px solid;text-align:center}img{max-width:100%;max-height:100%;display:block;margin-left:auto;margin-right:auto}</style>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-82728104-5', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


    
</head>

<body>
<div class="header">
    <h1>
        <a href="/">Alpha Coder</a>
        <div class="header-menu">
            <a href="/blog/">Blog</a>
            <a href="/courses/">Courses</a>
            <a href="http://bit.ly/nksnewsletter">Newsletter</a>
        </div>
    </h1>
</div>
<div id="content">

<header>
    <h1>Deploy your React-Django app on Heroku</h1>
    

<div class="post-meta">
    Date &#x5b;
    <time datetime="2018-01-30">Jan 30, 2018</time>
    &#x5d;
    Tag &#x5b;
    <a href="http://alphacoder.xyz/tag/react/">React</a>
    <a href="http://alphacoder.xyz/tag/django/">Django</a>
    <a href="http://alphacoder.xyz/tag/heroku/">Heroku</a>
    &#x5d;
</div>
</header>
<article>
    

<p>This is a follow up to my post on <em><a href="https://alphacoder.xyz/dead-simple-react-django-setup/">setting up a React-Django web app</a></em>. You can take a quick glance if you’ve not seen it yet.</p>

<p><strong>TL;DR: The setup is deployed at</strong> <a href="http://react-django.herokuapp.com/"><strong>http://react-django.herokuapp.com</strong></a> <strong>(nothing much there actually) and the code at</strong> <a href="https://github.com/nicholaskajoh/React-Django"><strong>https://github.com/nicholaskajoh/React-Django</strong></a><strong>.</strong></p>

<hr />

<p>We’re going to be deploying the app we setup in the previous post on Heroku. Heroku is a popular cloud hosting platform (PaaS) and offers a generous free tier which we’ll be using.</p>

<h2 id="heroku-dashboard">Heroku dashboard</h2>

<p>First things first. You need a Heroku account. Head over to <a href="https://heroku.com">Heroku.com</a> and sign up/login, then go to your dashboard at <a href="https://dashboard.heroku.com">https://dashboard.heroku.com</a> and create a new app.</p>

<p><img src="https://cdn-images-1.medium.com/max/1000/1*J2mxZwYUbFFCTnXOORLMlw.png" alt="" /></p>

<h2 id="heroku-cli">Heroku CLI</h2>

<p>There are a couple deploy methods to choose from on Heroku (visit the <em>deploy</em> tab on the app page on the dashboard). Here, we’ll use the <em>Heroku Git</em> method via the <em>Heroku CLI</em>. You can use <a href="https://devcenter.heroku.com/articles/heroku-cli">this guide to learn how to set up Heroku CLI on your OS</a>.</p>

<p>Now, let’s link our project to the Heroku app we created using the Heroku CLI and Git.</p>

<ul>
<li>Initialize a Git repository in the root folder of the project with <code>git init</code> (you need to have Git installed on your computer).</li>
<li>Login with your Heroku account on the CLI using <code>heroku login</code>.</li>
<li>Add the Heroku remote via <code>heroku git:remote -a your-heroku-app</code>.</li>
</ul>

<p><img src="https://cdn-images-1.medium.com/max/800/1*A4icz0o5vRhq1zGDdpcLkQ.png" alt="" /></p>

<p>I already initialized Git in the project prior to this.</p>

<h2 id="heroku-buildpacks">Heroku buildpacks</h2>

<p>The React app build process depends on NPM, so we need Node.js. We also need Python to run Django.</p>

<p>Heroku uses <a href="https://devcenter.heroku.com/articles/buildpacks">buildpacks</a> to transform deployed code into slugs which can be executed by Dynos (server instances on Heroku). We’ll be needing two buildpacks. One for Node and another for Python.</p>

<p>Our app would run on a Python server, even though we’ll use Node/NPM to build/bundle the React frontend. So the Python buildpack will be the main one in our config. The main buildpack determines the process type of the Heroku app. You can <a href="https://devcenter.heroku.com/articles/using-multiple-buildpacks-for-an-app">read about multiple buildpacks</a> to understand how they work.</p>

<p>You can add buildpacks via the Heroku CLI. Head back to your terminal and run the following to set/add the buildpacks we need.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">$ heroku buildpacks:set heroku/python</pre></td></tr></table>
</div>
</div>
<p>Now add the buildpack for Node.js.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">$ heroku buildpacks:add --index 1 heroku/nodejs</pre></td></tr></table>
</div>
</div>
<p>We can see the buildpacks we’ve added by running <code>heroku buildpacks</code>. The last buildpack on the list determines the process type of the app.</p>

<p><img src="https://cdn-images-1.medium.com/max/800/1*cQr2gThuZbUr-sY4yKUwog.png" alt="" /></p>

<h2 id="package-json">package.json</h2>

<p>We need to tell the Node.js buildpack to build the React app after it has installed Node and NPM. We can do this by adding the build command <code>npm run build</code> in the <em>postinstall</em> hook.</p>

<p><img src="https://cdn-images-1.medium.com/max/800/1*lJJMhR8OnPe2YJXGbzn2YQ.png" alt="" /></p>

<p>See postinstall under scripts</p>

<p>Notice that I specified Node and NPM versions in <em>engines</em>. The buildpack will install these exact versions. It’s highly recommended you use the versions running on your PC to avoid errors from a version that might be incompatible with your code.</p>

<h2 id="procfile">Procfile</h2>

<p>Create a file called <em><a href="https://devcenter.heroku.com/articles/procfile">Procfile</a></em> (no file extension) in the project root and add the following code:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">release: python manage.py migrate
web: gunicorn reactdjango.wsgi --log-file -</pre></td></tr></table>
</div>
</div>
<p>Replace <code>reactdjango.wsgi</code> with <code>YOUR-DJANGO-APP-NAME.wsgi</code>.</p>

<h2 id="requirements-txt">requirements.txt</h2>

<p>The Python buildpack, after installing Python looks for <em>requirements.txt</em> to install the dependencies in it. Add the following to the requirements file, including all the other dependencies your Django app needs.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">django&gt;=2.1.2
gunicorn==19.7.1
whitenoise==3.3.1</pre></td></tr></table>
</div>
</div>
<p><strong>PS: Whitenoise helps to serve static files and Gunicorn is the HTTP server we’ll be using.</strong></p>

<p>By the way, you can specify the Python version you want by adding it to a file named <em>runtime.txt</em> in the project root.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">python-3.5.2</pre></td></tr></table>
</div>
</div>
<p>Configure whitenoise to serve static files by doing the following:</p>

<p>Add <em>static root</em> and <em>static files storage</em> in <em>settings.py</em></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))

STATIC_ROOT = os.path.join(BASE_DIR, &#39;staticfiles&#39;)
STATICFILES_STORAGE = &#39;whitenoise.django.GzipManifestStaticFilesStorage&#39;</pre></td></tr></table>
</div>
</div>
<p>Add whitenoise to your <em>wsgi.py</em> file.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">import os
from django.core.wsgi
import get_wsgi_application
from whitenoise.django import DjangoWhiteNoise

os.environ.setdefault(&#34;DJANGO_SETTINGS_MODULE&#34;, &#34;reactdjango.settings&#34;)

application = get_wsgi_application()
application = DjangoWhiteNoise(application)</pre></td></tr></table>
</div>
</div>
<h2 id="allowed-hosts">Allowed hosts</h2>

<p>In your <em>settings.py</em>, you need to add your Heroku domain to allowed hosts.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">ALLOWED_HOSTS = [&#39;react-django.herokuapp.com&#39;, &#39;127.0.0.1:8000&#39;]</pre></td></tr></table>
</div>
</div>
<p><strong>NB: I personally prefer to add allowed hosts using environment variables e.g with</strong> <a href="https://github.com/theskumar/python-dotenv"><strong>python-dotenv</strong></a><strong>.</strong></p>

<h2 id="commit-push">Commit, push</h2>

<p>It’s time to commit and push the changes. Phew!</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">$ git add .
$ git commit -m &#34;blah blah blah&#34;
$ git push heroku master</pre></td></tr></table>
</div>
</div>
<p>After the build is done and your app has been released, visit <em>YOUR-APP-NAME.herokuapp.com</em>. Neat!</p>

<p><em>Two libraries you might find really helpful when building your Django API are</em> <a href="http://www.django-rest-framework.org/"><em>Django Rest Framework</em></a> <em>and</em> <a href="https://github.com/ottoyiu/django-cors-headers/"><em>Django CORS Headers</em></a><em>. You should check them out!</em></p>

<p>If you had any issues deploying please share in the comments. A lot of times, things don’t work the first time.</p>

</article>

<a href="http://bit.ly/nksnewsletter" target="_blank">Subscribe to my newsletter</a> for updates on new articles, courses and more. Also, consider supporting <a href="https://www.patreon.com/user?u=16416296" target="_blank">Alpha Coder on Patreon</a>.<br>


  <br><div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "alphacoderxyz" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



    </div>
<div class="footer">
    
    
    <div class="footer-links">
        <a href="http://twitter.com/nicholaskajoh">Twitter</a>
        <a href="https://github.com/nicholaskajoh">GitHub</a>
        <a href="https://www.patreon.com/user?u=16416296">Patreon</a>
        <a href="/post/index.xml">RSS</a>
    </div>
    

    
    
    <div class="copyright">© [ This Year ] Nicholas Kajoh</div>
    
</div>
</body>

</html>