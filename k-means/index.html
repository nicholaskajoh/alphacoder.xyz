<!DOCTYPE html>
<html><head>
<title>K Means</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">












<script defer data-domain="alphacoder.xyz" src="https://analytics.terna.io/js/plausible.js"></script>


<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">


  




<link rel="icon" href="https://alphacoder.xyz/images/alpha-coder-logo-v1-small.png">



<link rel="stylesheet" href="https://alphacoder.xyz/scss/journal.min.e3bbe8a4e9def42361d46a08558b2ceeb666c944d881cbcfa75a3435be6afa74.css" integrity="sha256-47vopOne9CNh1GoIVYss7rZmyUTYgcvPp1o0Nb5q&#43;nQ=" media="screen">



<link rel="stylesheet" href="https://alphacoder.xyz/scss/dark-mode.min.16749f4d04ce998e04ecf1c45f01d051b413e9693378f8834e15973538e1d735.css" integrity="sha256-FnSfTQTOmY4E7PHEXwHQUbQT6WkzePiDThWXNTjh1zU=" media="screen">


<script src="/vendor/js/loadCSS.js"></script>
<script>
  loadCSS("https://fonts.googleapis.com/css?family=Lora|Montserrat|Fira+Mono|Noto+Serif+SC|Material+Icons|Exo+2");
</script>






  <script src="/js/toc.js"></script>







<script src="https://cdn.jsdelivr.net/npm/vue-disqus@3/dist/vue-disqus.js"></script>








</head>
<body>
    	<div id="app"><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://alphacoder.xyz/">
    
        <div class="nav-title">
            Alpha Coder
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/blog/">
                Blog
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="https://codereviewclub.com">
                Code Review Club
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="https://www.youtube.com/channel/UC1vg_0J9BGfahmc7flbiwJw">
                Videos
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="https://tinyletter.com/nicholaskajoh">
                Newsletter
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
<a href="https://twitter.com/AlphaCoderXYZ">
    Twitter
</a>
<br>

<a href="mailto:support@alphacoder.xyz">
    Email
</a>
<br>

<a href="/blog/index.xml">
    RSS
</a>
<br>


        &copy;
    
    Copyright 2017 to ‚àû. Nicholas Kajoh. All rights reserved.
    

    </div>
    
</div><div id="extraContainer" class="extra-container">
    
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- OUTLINE -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#the-ml-chops-series" onclick="onNavClick(`#the-ml-chops-series-nav`)" id="the-ml-chops-series-nav">
									The ML Chops series
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#how-itworks" onclick="onNavClick(`#how-itworks-nav`)" id="how-itworks-nav">
									How it¬†works
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#code" onclick="onNavClick(`#code-nav`)" id="code-nav">
									Code
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#step-1" onclick="onNavClick(`#step-1-nav`)" id="step-1-nav">
									Step 1
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#step-21" onclick="onNavClick(`#step-21-nav`)" id="step-21-nav">
									Step 2.1
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#step-22" onclick="onNavClick(`#step-22-nav`)" id="step-22-nav">
									Step 2.2
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#step-3" onclick="onNavClick(`#step-3-nav`)" id="step-3-nav">
									Step 3
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#step-4" onclick="onNavClick(`#step-4-nav`)" id="step-4-nav">
									Step 4
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#step-5" onclick="onNavClick(`#step-5-nav`)" id="step-5-nav">
									Step 5
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>
<div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/blog/">
                    Blog
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="https://codereviewclub.com">
                    Code Review Club
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="https://www.youtube.com/channel/UC1vg_0J9BGfahmc7flbiwJw">
                    Videos
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="https://tinyletter.com/nicholaskajoh">
                    Newsletter
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- OUTLINE -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#the-ml-chops-series" onclick="onNavClick(`#the-ml-chops-series-nav`)" id="the-ml-chops-series-nav">
									The ML Chops series
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#how-itworks" onclick="onNavClick(`#how-itworks-nav`)" id="how-itworks-nav">
									How it¬†works
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#code" onclick="onNavClick(`#code-nav`)" id="code-nav">
									Code
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#step-1" onclick="onNavClick(`#step-1-nav`)" id="step-1-nav">
									Step 1
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#step-21" onclick="onNavClick(`#step-21-nav`)" id="step-21-nav">
									Step 2.1
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#step-22" onclick="onNavClick(`#step-22-nav`)" id="step-22-nav">
									Step 2.2
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#step-3" onclick="onNavClick(`#step-3-nav`)" id="step-3-nav">
									Step 3
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#step-4" onclick="onNavClick(`#step-4-nav`)" id="step-4-nav">
									Step 4
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#step-5" onclick="onNavClick(`#step-5-nav`)" id="step-5-nav">
									Step 5
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://alphacoder.xyz/">
            Alpha Coder
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://alphacoder.xyz/">
        <div class="single-column-header-title">Alpha Coder</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title" v-pre>
                    K Means
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2018-05-01
                        </time>
                        

                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tag/ml-chops-series">ML Chops Series</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <p>We‚Äôve been talking <strong>classification</strong> for a while now‚Ää‚Äî‚Ääfrom <em>K Nearest Neighbors</em> to <em>Naive Bayes</em> to <em>Support Vector Machines</em>. In this post, we‚Äôll be looking at <strong>clustering</strong> using an algorithm called <strong><em>K Means</em></strong>. Let‚Äôs dive in&hellip;</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*C2uxvEivKa4FQYimkl6OJA.jpeg" alt=""></p>
<h1 id="the-ml-chops-series">The ML Chops series</h1>
<ul>
<li><a href="/linear-regression">Linear Regression</a></li>
<li><a href="/k-nearest-neighbors">K Nearest Neighbors</a></li>
<li><a href="/naive-bayes">Naive Bayes</a></li>
<li><a href="/support-vector-machine">Support Vector Machine</a></li>
<li>K Means (this article)</li>
</ul>
<p>K Means is an unsupervised learning algorithm that tries to cluster data into a specified number of groups, <em>K</em> based on feature similarity. The algorithm works iteratively to assign each data point to one of <em>K</em> groups. Each group is identified by a centroid (the center point of the group) and data points are grouped with the centroid they‚Äôre closest to. The centroids are determined during training through optimization.</p>
<p><strong><em>NB:</em></strong> <em>Unsupervised learning involves training an algorithm with unclassified or unlabeled data. It‚Äôs up to the algorithm to figure out a pattern in the data and, in the case of clustering, group similar data points together.</em></p>
<h3 id="how-itworks">How it¬†works</h3>
<ol>
<li>First, we select the number of groups/clusters, K we want. To figure out what value of K to use, you can visualize the data to see how many groups it can be separated into. This is not always possible because the data can be in more than 3 dimensions. In such a case, you need to have an expectation from your data. Maybe you‚Äôre trying to separate good oranges from bad ones. In this case, K = 2.</li>
<li>Next, we create K centroids. The easiest way to do this is to use the first K feature sets from our data or just do a random selection.</li>
<li>These centroids are not optimized. The training process involves moving the centroids until they‚Äôre at the center of each group, at which point we can quite correctly determine what group a given data point should be in (the centroid to which it‚Äôs closest). With our starting centroids, we iterate through the data grouping each point to the centroid it‚Äôs closest to. Afterwards, we change the centroids by taking the <strong>mean</strong> of all the data points in each group.</li>
<li>This process continues repetitively until we notice the centroids are not changing much or at all. This means we‚Äôre optimized!</li>
</ol>
<h3 id="code">Code</h3>
<p>First things first, the data</p>
<pre><code>import numpy as np

data = np.array([  
    [4, 3], [0, 0], [2, 4], [3, 4], [5, 4], [-2, 1], [-3, 0], [-3, -3], [8, 12], [11, 11], [9, 10]  
])
</code></pre>
<p>Visually, the above data looks like this</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*qsdD6dP7zqBd-jQO2sg0pQ.png" alt=""></p>
<p>From the graph you can easily see the data can be grouped into 3 clusters. Thus <code>K = 3</code>.</p>
<pre><code>K = 3  
tol = 0.001  
max_iter = 25
</code></pre>
<p>Notice the variables <code>tol</code> and <code>max_ter</code>. <code>tol</code> stands for tolerance and represents a percentage (0.001%). As we said earlier, we know we‚Äôre optimized when there‚Äôs little or no change in the centroids. If the change is greater than 0.001%, we tolerate and keep iterating.</p>
<p>But we can‚Äôt keep iterating forever/for too long in the case where we can‚Äôt optimize further and the change remains greater than 0.001. So we set <code>max_iter</code>, the maximum number of iterations we‚Äôre willing to do.</p>
<p>Next, let‚Äôs create the centroids. Their initial values would be the first K data points.</p>
<pre><code>centroids = {}  
for i in range(K):  
    centroids[i] = data[i]
</code></pre>
<p>Now unto the meat of the algorithm which is the optimization</p>
<pre><code>groups = {}  
for i in range(max_iter):  
    # step 1  
    for j in range(K):  
        groups[j] = []

    # step 2  
    for feature_set in data:  
        # step 2.1  
        distances = [np.linalg.norm(feature_set - centroids[centroid_key]) for centroid_key in centroids]

        # step 2.2  
        group = distances.index(min(distances))  
        groups[group].append(feature_set)

    # step 3  
    old_centroids = dict(centroids)

    # step 4  
    for j in range(K):  
        centroids[j] = np.average(groups[j], axis=0)

    # step 5  
    optimized = True  
    for centroid_key in centroids:  
        old_centroid = old_centroids[centroid_key]  
        new_centroid = centroids[centroid_key]  
        a = np.array(new_centroid - old_centroid)  
        b = np.array(old_centroid)  
        change = np.divide(a, b, out=np.zeros_like(a), where=b!=0)

        if abs(np.sum(change * 100.0)) &gt; tol:  
            optimized = False  
            break  
    if optimized:  
        break
</code></pre>
<p>Let break things down step by step‚Ä¶</p>
<h4 id="step-1">Step 1</h4>
<p>Initialize the <code>groups</code> dictionary with K empty arrays. This ensures <code>groups</code> is empty at the start of each iteration.</p>
<h4 id="step-21">Step 2.1</h4>
<p>Iterate through the data, calculating the euclidean distance of a given feature set from all the centroids.</p>
<h4 id="step-22">Step 2.2</h4>
<p>The feature set is added to the group of the centroid it‚Äôs closest to.</p>
<h4 id="step-3">Step 3</h4>
<p>Store the current centroids in <code>old_centroids</code>. The centroids are going to change soon. But we need the old centroids to see how much has changed since the last iteration.</p>
<h4 id="step-4">Step 4</h4>
<p>Calculate the new centroids by taking the average of all the feature sets in each centroid group.</p>
<h4 id="step-5">Step 5</h4>
<p>Check if the change in any of the centroids is greater than 0.001%. If yes, then we‚Äôre not yet optimized.</p>
<p>Here‚Äôs the full code for your perusal. It includes some lines of matplotlib code to visualize the data.</p>
<script src="https://gist.github.com/nicholaskajoh/a667e20925abfb5f8ad9bf748b5092fe.js"></script>
<p><img src="https://cdn-images-1.medium.com/max/800/1*xOImz1NtPQd8NrG5Y0AHWQ.png" alt=""></p>
<p>Check out the ML Chops repo for a class-based implementation and an example with real world data: <a href="https://github.com/nicholaskajoh/ML_Chops/tree/master/k-means">https://github.com/nicholaskajoh/ML_Chops/tree/master/k-means</a>.</p>
<p>If you have any questions, concerns or suggestions, don‚Äôt hesitate to comment! üëç</p>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">Last modified on 2018-05-01</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="https://alphacoder.xyz/scale-an-app-horizontally-using-a-load-balancer/">
			Next<br>How to scale an app horizontally using a load balancer
                </a>
                
                
                
                <a class="older-posts" href="https://alphacoder.xyz/image-upload-with-django-and-cloudinary/">
			Previous<br>Image upload with Django and Cloudinary
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                
<div id="disqus_thread"></div>
<script>
    

    var disqus_config = function () {
        
        this.page.url = 'https:\/\/alphacoder.xyz\/k-means\/';  
        
        
        this.page.identifier = 'https:\/\/alphacoder.xyz\/k-means\/'; 
    };
    (function() {
        var d = document, s = d.createElement('script');
        s.src = 'https://alphacoderxyz.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow"> comments powered by Disqus.  </a> </noscript>











            </div>
        </div>
    </div>


                    </div>
            </div><div id="single-column-footer">&copy;
    
    Copyright 2017 to ‚àû. Nicholas Kajoh. All rights reserved.
    
</div>
            </div>
    
    <script src="/js/journal.js"></script>
    </body>
</html>
