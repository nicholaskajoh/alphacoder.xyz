<!DOCTYPE html>
<html><head>
<title>Build a Facebook clone from scratch with PHP — Part 3</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">












<script defer data-domain="alphacoder.xyz" src="https://analytics.terna.io/js/plausible.js"></script>


<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">


  




<link rel="icon" href="https://alphacoder.xyz/images/alpha-coder-logo-v1-small.png">



<link rel="stylesheet" href="https://alphacoder.xyz/scss/journal.min.e3bbe8a4e9def42361d46a08558b2ceeb666c944d881cbcfa75a3435be6afa74.css" integrity="sha256-47vopOne9CNh1GoIVYss7rZmyUTYgcvPp1o0Nb5q&#43;nQ=" media="screen">



<link rel="stylesheet" href="https://alphacoder.xyz/scss/dark-mode.min.16749f4d04ce998e04ecf1c45f01d051b413e9693378f8834e15973538e1d735.css" integrity="sha256-FnSfTQTOmY4E7PHEXwHQUbQT6WkzePiDThWXNTjh1zU=" media="screen">


<script src="/vendor/js/loadCSS.js"></script>
<script>
  loadCSS("https://fonts.googleapis.com/css?family=Lora|Montserrat|Fira+Mono|Noto+Serif+SC|Material+Icons|Exo+2");
</script>






  <script src="/js/toc.js"></script>







<script src="https://cdn.jsdelivr.net/npm/vue-disqus@3/dist/vue-disqus.js"></script>








</head>
<body>
    	<div id="app"><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://alphacoder.xyz/">
    
        <div class="nav-title">
            Alpha Coder
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/blog/">
                Blog
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags/">
                Tags
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="https://www.youtube.com/@alphacoderblog">
                Videos
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
<a href="https://twitter.com/AlphaCoderXYZ">
    Twitter
</a>
<br>

<a href="mailto:support@alphacoder.xyz">
    Email
</a>
<br>

<a href="/blog/index.xml">
    RSS
</a>
<br>


        &copy;
    
    Copyright 2017 to ∞. Nicholas Kajoh. All rights reserved.
    

    </div>
    
</div><div id="extraContainer" class="extra-container">
    
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- OUTLINE -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#all-parts" onclick="onNavClick(`#all-parts-nav`)" id="all-parts-nav">
									All parts
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#functionsphp" onclick="onNavClick(`#functionsphp-nav`)" id="functionsphp-nav">
									Functions.php
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#connect-todb" onclick="onNavClick(`#connect-todb-nav`)" id="connect-todb-nav">
									Connect to DB
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#view-posts" onclick="onNavClick(`#view-posts-nav`)" id="view-posts-nav">
									View posts
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#make-posts" onclick="onNavClick(`#make-posts-nav`)" id="make-posts-nav">
									Make posts
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#delete-posts" onclick="onNavClick(`#delete-posts-nav`)" id="delete-posts-nav">
									Delete posts
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>
<div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/blog/">
                    Blog
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags/">
                    Tags
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="https://www.youtube.com/@alphacoderblog">
                    Videos
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- OUTLINE -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#all-parts" onclick="onNavClick(`#all-parts-nav`)" id="all-parts-nav">
									All parts
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#functionsphp" onclick="onNavClick(`#functionsphp-nav`)" id="functionsphp-nav">
									Functions.php
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#connect-todb" onclick="onNavClick(`#connect-todb-nav`)" id="connect-todb-nav">
									Connect to DB
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#view-posts" onclick="onNavClick(`#view-posts-nav`)" id="view-posts-nav">
									View posts
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#make-posts" onclick="onNavClick(`#make-posts-nav`)" id="make-posts-nav">
									Make posts
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#delete-posts" onclick="onNavClick(`#delete-posts-nav`)" id="delete-posts-nav">
									Delete posts
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://alphacoder.xyz/">
            Alpha Coder
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://alphacoder.xyz/">
        <div class="single-column-header-title">Alpha Coder</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title" v-pre>
                    Build a Facebook clone from scratch with PHP — Part 3
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2017-07-17
                        </time>
                        

                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tag/facebook-clone-series">Facebook Clone Series</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <h1 id="all-parts">All parts</h1>
<ul>
<li><a href="/facebook-clone-1">Build a Facebook clone from scratch with PHP — Part 1</a></li>
<li><a href="/facebook-clone-2">Build a Facebook clone from scratch with PHP — Part 2</a></li>
<li>Build a Facebook clone from scratch with PHP — Part 3 (this article)</li>
<li><a href="/facebook-clone-4">Build a Facebook clone from scratch with PHP — Part 4</a></li>
<li><a href="/facebook-clone-5">Build a Facebook clone from scratch with PHP — Part 5</a></li>
<li><a href="/facebook-clone-6">Build a Facebook clone from scratch with PHP — Part 6</a></li>
<li><a href="/facebook-clone-7">Build a Facebook clone from scratch with PHP — Part 7</a></li>
</ul>
<p>Posts are the heart and soul of Facebook. In this part, we&rsquo;ll be writing code that would allow us view, make and delete posts on FaceClone.</p>
<p><img src="/images/fbc3/faceclone-home.png" alt=""></p>
<h1 id="functionsphp">Functions.php</h1>
<p>In the spirit of code reusability A.K.A writing DRY (<a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">Don&rsquo;t Repeat Yourself</a>) code, let&rsquo;s create a functions.php file in the root of our project. We&rsquo;ll use this file to write different bits of code — functions — which can be used across our app. Now include functions.php at the top of all app pages like so:</p>
<pre><code>&lt;?php require_once &quot;functions.php&quot;; ?&gt;
</code></pre>
<h1 id="connect-todb">Connect to DB</h1>
<p>To interact with a database e.g perform CRUD (Create, Read, Update, Delete) operations, we must connect to it. Connecting to MySQL with PHP is pretty easy. Create a function in functions.php called db_connect and add the following code like so:</p>
<pre><code>&lt;?php
    function db_connect() {
        global $conn; // db connection variable
        $db_server = &quot;localhost&quot;;
        $username = &quot;root&quot;;
        $password = &quot;&quot;;
        $db_name = &quot;faceclone&quot;;
        // create a connection
        $conn = new mysqli($db_server, $username, $password, $db_name);
        // check connection for errors
        if ($conn-&gt;connect_error) {
            die(&quot;Error: &quot; . $conn-&gt;connect_error);
        }
        // uncomment the line below to confirm a connection is established
        // echo '&lt;h1 style=&quot;color: green;&quot;&gt;Connected to DB!&lt;/h1&gt;';
        // your can clear these comments afterwards
    }
</code></pre>
<p>You can call this function in any page like so:</p>
<pre><code>&lt;?php require_once &quot;functions.php&quot;; ?&gt;
&lt;?php include &quot;header.php&quot;; ?&gt;
&lt;?php 
    db_connect();
?&gt;
&lt;!-- main --&gt;
&lt;main class=&quot;container&quot;&gt;
...
</code></pre>
<p><img src="/images/fbc3/db-connect.jpg" alt="">
<em>Connect FaceClone to the DB</em></p>
<p>The above code is quite self-explanatory. We specify our database server name, username, password and the particular database we want to access. Then, we use the MySQLi extension to establish a connection to the database. There are other extensions and therefore ways to connect to a database. Also, we can choose to <a href="https://www.w3schools.com/php/php_mysql_connect.asp">write the code procedurally or using object-oriented programming</a>.</p>
<p>Ensure your MySQL server is running. You can start the server from XAMPP&rsquo;s control panel.</p>
<p><img src="/images/fbc3/xampp-control-panel.jpg" alt="">
<em>XAMPP control panel</em></p>
<p>Now that we have a connection, let&rsquo;s write code to get posts from the database. Wait! There&rsquo;s no data in there, is there? Let&rsquo;s quickly generate some data. Head over to PHP My Admin and have some fun.</p>
<p>Go to faceclone &gt; posts &gt; insert&hellip;</p>
<p><img src="/images/fbc3/create-dummy-data.png" alt="">
<em>Add dummy data to your DB</em></p>
<p><strong>NB:</strong> I set user_id to 0 cos we don&rsquo;t have any users yet.</p>
<h1 id="view-posts">View posts</h1>
<p>Now, let&rsquo;s get the posts from the DB to our home page. There&rsquo;s already template code for posts with some static data. Using the template, we&rsquo;ll have something like this:</p>
<pre><code>&lt;!-- post --&gt;
&lt;?php 
    $sql = &quot;SELECT * FROM posts&quot;;
    $result = $conn-&gt;query($sql);
    if ($result-&gt;num_rows &gt; 0) {
        while($post = $result-&gt;fetch_assoc()) {
?&gt;
            &lt;div class=&quot;panel panel-default&quot;&gt;
            &lt;div class=&quot;panel-body&quot;&gt;
                &lt;p&gt;&lt;?php echo $post['content']; ?&gt;&lt;/p&gt;
            &lt;/div&gt;
            &lt;div class=&quot;panel-footer&quot;&gt;
                &lt;span&gt;posted &lt;?php echo $post['created_at']; ?&gt; by nicholaskajoh&lt;/span&gt; 
                &lt;span class=&quot;pull-right&quot;&gt;&lt;a class=&quot;text-danger&quot; href=&quot;php/delete-post.php?id=&lt;?php echo $post['id']; ?&gt;&quot;&gt;[delete]&lt;/a&gt;&lt;/span&gt;
            &lt;/div&gt;
            &lt;/div&gt;
&lt;?php
        }
    } else {
?&gt;
        &lt;p class=&quot;text-center&quot;&gt;No posts yet!&lt;/p&gt;
&lt;?php
    }
    $conn-&gt;close();
?&gt;
&lt;!-- ./post --&gt;
</code></pre>
<p>Nothing much here. First, we write an SQL query and execute it, then we get the results and display each post using a while loop. The query SELECT * FROM posts simply says &ldquo;get all the records from the posts table&rdquo;.</p>
<p><strong>Tip:</strong> The words (in the code) with <code>$</code> before them are variable names (e.g <code>$result</code>). We use the dollar sign to denote variable names in PHP.</p>
<p>We&rsquo;re not done yet though. Wouldn&rsquo;t it be better to display the more recent posts first? We can do that by adjusting our query a little bit.</p>
<pre><code>SELECT * FROM posts ORDER BY created_at DESC
</code></pre>
<p>Bingo!</p>
<h1 id="make-posts">Make posts</h1>
<p>We don&rsquo;t expect users to use PHP MyAdmin to make posts on FaceClone, do we? It only seems logical that we allow users create posts in our app. Thanks to the template, we have a nifty little textbox on the home page.</p>
<p><em>This point in our journey looks like a good time to separate concerns. We could write the code that&rsquo;ll create a new post in home.php, but this can lead to messy code as there may be too many moving parts, so to speak, in one file. Let&rsquo;s avoid this by creating a new folder called php in the root of our project to store php files which aren&rsquo;t pages. functions.php fits the description of a file that should be in the php folder. Let&rsquo;s leave it where it is, though. I like to keep it in the root folder as it serves kind of like a general purpose.</em></p>
<p>Create a new file in the php folder called create-post.php and add the following code:</p>
<pre><code>&lt;?php
    require_once &quot;../functions.php&quot;;
    db_connect();
    $sql = &quot;INSERT INTO posts (content, user_id) VALUES (?, 0)&quot;;
    $statement = $conn-&gt;prepare($sql);
    $statement-&gt;bind_param('s', $_POST['content']);
    if ($statement-&gt;execute()) {
        redirect_to(&quot;/home.php&quot;);
    } else {
        echo &quot;Error: &quot; . $conn-&gt;error;
    }
    $conn-&gt;close();
</code></pre>
<p>Now edit the form in home.php by adding php/create-post.php as the value for the action attribute.</p>
<pre><code>&lt;!-- post form --&gt;
&lt;form method=&quot;post&quot; action=&quot;php/create-post.php&quot;&gt;
&lt;div class=&quot;input-group&quot;&gt;
    &lt;input class=&quot;form-control&quot; type=&quot;text&quot; name=&quot;content&quot; placeholder=&quot;Make a post…&quot;&gt;
    &lt;span class=&quot;input-group-btn&quot;&gt;
    &lt;button class=&quot;btn btn-success&quot; type=&quot;submit&quot; name=&quot;post&quot;&gt;Post&lt;/button&gt;
    &lt;/span&gt;
&lt;/div&gt;
&lt;/form&gt;&lt;hr&gt;
&lt;!-- ./post form --&gt;
</code></pre>
<p>The code to create a post is straightforward. We write a query and execute it. If it&rsquo;s executed (meaning everything went well), we redirect to the home page where we can see the newly created post. Else, we throw an error.</p>
<p><code>$_POST</code> is a superglobal. superglobals are variables that are always accessible regardless of scope i.e you can access them from any function, class or file without having to do anything. $_POST is an array that contains data sent in POST requests. When a user submits the form to create a post, we can access the content in <code>$_POST</code> variable using <code>$_POST['content']</code>.</p>
<p><strong>NB:</strong> Ensure the default value for the created_at column of the posts table is set to <code>CURRENT_TIMESTAMP</code>.
The redirect_to method is a custom method. Add the definition to functions.php.</p>
<pre><code>function redirect_to($url) {
    header(&quot;Location: &quot; . $url);
    exit();
}
</code></pre>
<h1 id="delete-posts">Delete posts</h1>
<p>Create a new file in the php folder. Call it delete-post.php. Similar to create-post.php, we have:</p>
<pre><code>&lt;?php
    require_once &quot;../functions.php&quot;;
    db_connect();
    $sql = &quot;DELETE FROM posts WHERE id = ?&quot;;
    $statement = $conn-&gt;prepare($sql);
    $statement-&gt;bind_param('i', $_GET['id']);
    if ($statement-&gt;execute()) {
        redirect_to(&quot;/home.php&quot;);
    } else {
        echo &quot;Error: &quot; . $conn-&gt;error;
    }
    $conn-&gt;close();
</code></pre>
<p>Now when we click the delete link for a post, it&rsquo;s gone for good! 😊</p>
<p><code>$_GET</code> is another superglobal. As you might imagine, it contains data sent from GET requests.</p>
<p>That&rsquo;s it for part 3!</p>
<p><strong>The final code for this part is contained in my FaceClone repo here: <a href="https://github.com/nicholaskajoh/faceclone">https://github.com/nicholaskajoh/faceclone</a>. Visit the link and click on the part-3 folder to see progress made so far.</strong></p>
<p>Next: <a href="/facebook-clone-4">Build a Facebook clone from scratch with PHP — Part 4</a>.</p>
<p>Previous: <a href="/facebook-clone-2">Build a Facebook clone from scratch with PHP — Part 2</a>.</p>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">Last modified on 2019-04-21</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="https://alphacoder.xyz/facebook-clone-4/">
			Next<br>Build a Facebook clone from scratch with PHP — Part 4
                </a>
                
                
                
                <a class="older-posts" href="https://alphacoder.xyz/facebook-clone-2/">
			Previous<br>Build a Facebook clone from scratch with PHP — Part 2
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                
<div id="disqus_thread"></div>
<script>
    

    var disqus_config = function () {
        
        this.page.url = 'https:\/\/alphacoder.xyz\/facebook-clone-3\/';  
        
        
        this.page.identifier = 'https:\/\/alphacoder.xyz\/facebook-clone-3\/'; 
    };
    (function() {
        var d = document, s = d.createElement('script');
        s.src = 'https://alphacoderxyz.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow"> comments powered by Disqus.  </a> </noscript>











            </div>
        </div>
    </div>


                    </div>
            </div><div id="single-column-footer">&copy;
    
    Copyright 2017 to ∞. Nicholas Kajoh. All rights reserved.
    
</div>
            </div>
    
    <script src="/js/journal.js"></script>
    </body>
</html>
