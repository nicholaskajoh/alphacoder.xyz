<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Build a Facebook clone from scratch with PHP — Part 3 | Alpha Coder</title>

    <link href="https://fonts.googleapis.com/css?family=Merriweather" rel="stylesheet">
    
    <style>body{margin:40px auto;max-width:650px;line-height:1.6;font-family:merriweather,serif;font-size:16px;color:#444;padding:0 10px}h1,h2,h3{line-height:1.2}div.header h1{padding-top:0;padding-bottom:8px;margin-bottom:24px;font-size:15px;font-weight:400;border-bottom:1px solid}.header-menu{float:right}.header-menu a{padding-left:5px}ul.pagination{list-style-type:none;text-align:center;padding:0}ul.pagination>li{padding:0 8px;display:inline-block}div.footer{border-top:1px solid;text-align:center}.footer-links a{padding:0 5px}img{max-width:100%;max-height:100%;display:block;margin-left:auto;margin-right:auto}a,a:visited,a:hover,a:active{color:#00e}.posts-list li:not(:last-child){padding-bottom:20px}.post-meta a:not(:last-child){padding-right:5px}blockquote{margin-top:10px;margin-bottom:10px;margin-left:50px;padding-left:15px;border-left:3px solid #ccc;background-color:#f9f9f9;font-style:italic}</style>

    

    
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-82728104-5', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    

    

    <meta property="og:title" content="Build a Facebook clone from scratch with PHP — Part 3" />
<meta property="og:description" content="All parts  Build a Facebook clone from scratch with PHP — Part 1 Build a Facebook clone from scratch with PHP — Part 2 Build a Facebook clone from scratch with PHP — Part 3 (this article) Build a Facebook clone from scratch with PHP — Part 4 Build a Facebook clone from scratch with PHP — Part 5 Build a Facebook clone from scratch with PHP — Part 6 Build a Facebook clone from scratch with PHP — Part 7  Posts are the heart and soul of Facebook." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://alphacoder.xyz/facebook-clone-3/" />
<meta property="article:published_time" content="2017-07-17T08:35:09+01:00" />
<meta property="article:modified_time" content="2017-07-17T08:35:09+01:00" />

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Build a Facebook clone from scratch with PHP — Part 3"/>
<meta name="twitter:description" content="All parts  Build a Facebook clone from scratch with PHP — Part 1 Build a Facebook clone from scratch with PHP — Part 2 Build a Facebook clone from scratch with PHP — Part 3 (this article) Build a Facebook clone from scratch with PHP — Part 4 Build a Facebook clone from scratch with PHP — Part 5 Build a Facebook clone from scratch with PHP — Part 6 Build a Facebook clone from scratch with PHP — Part 7  Posts are the heart and soul of Facebook."/>

    <meta itemprop="name" content="Build a Facebook clone from scratch with PHP — Part 3">
<meta itemprop="description" content="All parts  Build a Facebook clone from scratch with PHP — Part 1 Build a Facebook clone from scratch with PHP — Part 2 Build a Facebook clone from scratch with PHP — Part 3 (this article) Build a Facebook clone from scratch with PHP — Part 4 Build a Facebook clone from scratch with PHP — Part 5 Build a Facebook clone from scratch with PHP — Part 6 Build a Facebook clone from scratch with PHP — Part 7  Posts are the heart and soul of Facebook.">
<meta itemprop="datePublished" content="2017-07-17T08:35:09&#43;01:00" />
<meta itemprop="dateModified" content="2017-07-17T08:35:09&#43;01:00" />
<meta itemprop="wordCount" content="1184">



<meta itemprop="keywords" content="Facebook Clone Series," />
    
    <script data-ad-client="ca-pub-8057819600718362" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>


<body>
<div class="header">
    <h1>
        <a href="/">Alpha Coder</a>
        <div class="header-menu">
            <a href="/blog/">Blog</a>
            <a href="https://courses.alphacoder.xyz">Courses</a>
            <a href="https://community.alphacoder.xyz">Community</a>
        </div>
    </h1>
</div>
<div id="content">

<header>
    <h1>Build a Facebook clone from scratch with PHP — Part 3</h1>
    

<div class="post-meta">
    <time datetime="2017-07-17">Jul 17, 2017</time>
    | Tags:
    <a href="http://alphacoder.xyz/tag/facebook-clone-series/">Facebook Clone Series</a>
</div>
</header>
<article>
    <h1 id="all-parts">All parts</h1>
<ul>
<li><a href="/facebook-clone-1">Build a Facebook clone from scratch with PHP — Part 1</a></li>
<li><a href="/facebook-clone-2">Build a Facebook clone from scratch with PHP — Part 2</a></li>
<li>Build a Facebook clone from scratch with PHP — Part 3 (this article)</li>
<li><a href="/facebook-clone-4">Build a Facebook clone from scratch with PHP — Part 4</a></li>
<li><a href="/facebook-clone-5">Build a Facebook clone from scratch with PHP — Part 5</a></li>
<li><a href="/facebook-clone-6">Build a Facebook clone from scratch with PHP — Part 6</a></li>
<li><a href="/facebook-clone-7">Build a Facebook clone from scratch with PHP — Part 7</a></li>
</ul>
<p>Posts are the heart and soul of Facebook. In this part, we&rsquo;ll be writing code that would allow us view, make and delete posts on FaceClone.</p>
<p><img src="/images/fbc3/faceclone-home.png" alt=""></p>
<h1 id="functionsphp">Functions.php</h1>
<p>In the spirit of code reusability A.K.A writing DRY (<a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">Don&rsquo;t Repeat Yourself</a>) code, let&rsquo;s create a functions.php file in the root of our project. We&rsquo;ll use this file to write different bits of code — functions — which can be used across our app. Now include functions.php at the top of all app pages like so:</p>
<pre><code>&lt;?php require_once &quot;functions.php&quot;; ?&gt;
</code></pre>
<h1 id="connect-todb">Connect to DB</h1>
<p>To interact with a database e.g perform CRUD (Create, Read, Update, Delete) operations, we must connect to it. Connecting to MySQL with PHP is pretty easy. Create a function in functions.php called db_connect and add the following code like so:</p>
<pre><code>&lt;?php
    function db_connect() {
        global $conn; // db connection variable
        $db_server = &quot;localhost&quot;;
        $username = &quot;root&quot;;
        $password = &quot;&quot;;
        $db_name = &quot;faceclone&quot;;
        // create a connection
        $conn = new mysqli($db_server, $username, $password, $db_name);
        // check connection for errors
        if ($conn-&gt;connect_error) {
            die(&quot;Error: &quot; . $conn-&gt;connect_error);
        }
        // uncomment the line below to confirm a connection is established
        // echo '&lt;h1 style=&quot;color: green;&quot;&gt;Connected to DB!&lt;/h1&gt;';
        // your can clear these comments afterwards
    }
</code></pre>
<p>You can call this function in any page like so:</p>
<pre><code>&lt;?php require_once &quot;functions.php&quot;; ?&gt;
&lt;?php include &quot;header.php&quot;; ?&gt;
&lt;?php 
    db_connect();
?&gt;
&lt;!-- main --&gt;
&lt;main class=&quot;container&quot;&gt;
...
</code></pre>
<p><img src="/images/fbc3/db-connect.jpg" alt="">
<em>Connect FaceClone to the DB</em></p>
<p>The above code is quite self-explanatory. We specify our database server name, username, password and the particular database we want to access. Then, we use the MySQLi extension to establish a connection to the database. There are other extensions and therefore ways to connect to a database. Also, we can choose to <a href="https://www.w3schools.com/php/php_mysql_connect.asp">write the code procedurally or using object-oriented programming</a>.</p>
<p>Ensure your MySQL server is running. You can start the server from XAMPP&rsquo;s control panel.</p>
<p><img src="/images/fbc3/xampp-control-panel.jpg" alt="">
<em>XAMPP control panel</em></p>
<p>Now that we have a connection, let&rsquo;s write code to get posts from the database. Wait! There&rsquo;s no data in there, is there? Let&rsquo;s quickly generate some data. Head over to PHP My Admin and have some fun.</p>
<p>Go to faceclone &gt; posts &gt; insert&hellip;</p>
<p><img src="/images/fbc3/create-dummy-data.png" alt="">
<em>Add dummy data to your DB</em></p>
<p><strong>NB:</strong> I set user_id to 0 cos we don&rsquo;t have any users yet.</p>
<h1 id="view-posts">View posts</h1>
<p>Now, let&rsquo;s get the posts from the DB to our home page. There&rsquo;s already template code for posts with some static data. Using the template, we&rsquo;ll have something like this:</p>
<pre><code>&lt;!-- post --&gt;
&lt;?php 
    $sql = &quot;SELECT * FROM posts&quot;;
    $result = $conn-&gt;query($sql);
    if ($result-&gt;num_rows &gt; 0) {
        while($post = $result-&gt;fetch_assoc()) {
?&gt;
            &lt;div class=&quot;panel panel-default&quot;&gt;
            &lt;div class=&quot;panel-body&quot;&gt;
                &lt;p&gt;&lt;?php echo $post['content']; ?&gt;&lt;/p&gt;
            &lt;/div&gt;
            &lt;div class=&quot;panel-footer&quot;&gt;
                &lt;span&gt;posted &lt;?php echo $post['created_at']; ?&gt; by nicholaskajoh&lt;/span&gt; 
                &lt;span class=&quot;pull-right&quot;&gt;&lt;a class=&quot;text-danger&quot; href=&quot;php/delete-post.php?id=&lt;?php echo $post['id']; ?&gt;&quot;&gt;[delete]&lt;/a&gt;&lt;/span&gt;
            &lt;/div&gt;
            &lt;/div&gt;
&lt;?php
        }
    } else {
?&gt;
        &lt;p class=&quot;text-center&quot;&gt;No posts yet!&lt;/p&gt;
&lt;?php
    }
    $conn-&gt;close();
?&gt;
&lt;!-- ./post --&gt;
</code></pre>
<p>Nothing much here. First, we write an SQL query and execute it, then we get the results and display each post using a while loop. The query SELECT * FROM posts simply says &ldquo;get all the records from the posts table&rdquo;.</p>
<p><strong>Tip:</strong> The words (in the code) with <code>$</code> before them are variable names (e.g <code>$result</code>). We use the dollar sign to denote variable names in PHP.</p>
<p>We&rsquo;re not done yet though. Wouldn&rsquo;t it be better to display the more recent posts first? We can do that by adjusting our query a little bit.</p>
<pre><code>SELECT * FROM posts ORDER BY created_at DESC
</code></pre>
<p>Bingo!</p>
<h1 id="make-posts">Make posts</h1>
<p>We don&rsquo;t expect users to use PHP MyAdmin to make posts on FaceClone, do we? It only seems logical that we allow users create posts in our app. Thanks to the template, we have a nifty little textbox on the home page.</p>
<p><em>This point in our journey looks like a good time to separate concerns. We could write the code that&rsquo;ll create a new post in home.php, but this can lead to messy code as there may be too many moving parts, so to speak, in one file. Let&rsquo;s avoid this by creating a new folder called php in the root of our project to store php files which aren&rsquo;t pages. functions.php fits the description of a file that should be in the php folder. Let&rsquo;s leave it where it is, though. I like to keep it in the root folder as it serves kind of like a general purpose.</em></p>
<p>Create a new file in the php folder called create-post.php and add the following code:</p>
<pre><code>&lt;?php
    require_once &quot;../functions.php&quot;;
    db_connect();
    $sql = &quot;INSERT INTO posts (content, user_id) VALUES (?, 0)&quot;;
    $statement = $conn-&gt;prepare($sql);
    $statement-&gt;bind_param('s', $_POST['content']);
    if ($statement-&gt;execute()) {
        redirect_to(&quot;/home.php&quot;);
    } else {
        echo &quot;Error: &quot; . $conn-&gt;error;
    }
    $conn-&gt;close();
</code></pre>
<p>Now edit the form in home.php by adding php/create-post.php as the value for the action attribute.</p>
<pre><code>&lt;!-- post form --&gt;
&lt;form method=&quot;post&quot; action=&quot;php/create-post.php&quot;&gt;
&lt;div class=&quot;input-group&quot;&gt;
    &lt;input class=&quot;form-control&quot; type=&quot;text&quot; name=&quot;content&quot; placeholder=&quot;Make a post…&quot;&gt;
    &lt;span class=&quot;input-group-btn&quot;&gt;
    &lt;button class=&quot;btn btn-success&quot; type=&quot;submit&quot; name=&quot;post&quot;&gt;Post&lt;/button&gt;
    &lt;/span&gt;
&lt;/div&gt;
&lt;/form&gt;&lt;hr&gt;
&lt;!-- ./post form --&gt;
</code></pre>
<p>The code to create a post is straightforward. We write a query and execute it. If it&rsquo;s executed (meaning everything went well), we redirect to the home page where we can see the newly created post. Else, we throw an error.</p>
<p><code>$_POST</code> is a superglobal. superglobals are variables that are always accessible regardless of scope i.e you can access them from any function, class or file without having to do anything. $_POST is an array that contains data sent in POST requests. When a user submits the form to create a post, we can access the content in <code>$_POST</code> variable using <code>$_POST['content']</code>.</p>
<p><strong>NB:</strong> Ensure the default value for the created_at column of the posts table is set to <code>CURRENT_TIMESTAMP</code>.
The redirect_to method is a custom method. Add the definition to functions.php.</p>
<pre><code>function redirect_to($url) {
    header(&quot;Location: &quot; . $url);
    exit();
}
</code></pre>
<h1 id="delete-posts">Delete posts</h1>
<p>Create a new file in the php folder. Call it delete-post.php. Similar to create-post.php, we have:</p>
<pre><code>&lt;?php
    require_once &quot;../functions.php&quot;;
    db_connect();
    $sql = &quot;DELETE FROM posts WHERE id = ?&quot;;
    $statement = $conn-&gt;prepare($sql);
    $statement-&gt;bind_param('i', $_GET['id']);
    if ($statement-&gt;execute()) {
        redirect_to(&quot;/home.php&quot;);
    } else {
        echo &quot;Error: &quot; . $conn-&gt;error;
    }
    $conn-&gt;close();
</code></pre>
<p>Now when we click the delete link for a post, it&rsquo;s gone for good! 😊</p>
<p><code>$_GET</code> is another superglobal. As you might imagine, it contains data sent from GET requests.</p>
<p>That&rsquo;s it for part 3!</p>
<p><strong>The final code for this part is contained in my FaceClone repo here: <a href="https://github.com/nicholaskajoh/faceclone">https://github.com/nicholaskajoh/faceclone</a>. Visit the link and click on the part-3 folder to see progress made so far.</strong></p>
<p>Next: <a href="/facebook-clone-4">Build a Facebook clone from scratch with PHP — Part 4</a>.</p>
<p>Previous: <a href="/facebook-clone-2">Build a Facebook clone from scratch with PHP — Part 2</a>.</p>

</article>




<form
  style="border: 1px solid #ccc; text-align: center; border-radius: 2px; margin: 15px 0;"
  action="https://tinyletter.com/nicholaskajoh"
  method="post"
  target="popupwindow" onsubmit="window.open('https://tinyletter.com/nicholaskajoh', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true">
    <div style="padding: 20px;">
      <h2 style="margin-top: 0;">Subscribe to the Alpha Coder Newsletter!</h2>

      <p>Get timely updates on new articles, courses and more from Nicholas Kajoh. Unsubscribe anytime.</p>
      
      <input
        type="text"
        style="width: 150px; height: 30px; padding-left: 5px; border: 1px solid #ccc; border-radius: 2px;"
        name="email"
        placeholder="night.king@westeros.org">
      <input type="hidden" value="1" name="embed">
      <input
        type="submit"
        style="height: 34px; color: #fff; background-color: #00e; border: 1px solid #00e; border-radius: 2px;"
        value="Subscribe">
    </div>
</form>




  
  
    <p>
      Previous post: <a href="http://alphacoder.xyz/facebook-clone-2/"><strong>Build a Facebook clone from scratch with PHP — Part 2</strong></a>
    </p>
  

  
    <p>
      Next post: <a href="http://alphacoder.xyz/facebook-clone-4/"><strong>Build a Facebook clone from scratch with PHP — Part 4</strong></a>
    </p>
  
  



  <br><div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "alphacoderxyz" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



    </div>
<div class="footer">
    
    
    <div class="footer-links">
        <a href="https://twitter.com/AlphaCoderXYZ">Twitter</a>
        <a href="https://www.linkedin.com/company/alphacoder">LinkedIn</a>
        <a href="mailto:support@alphacoder.xyz">Email</a>
        
        <a href="/blog/index.xml">RSS</a>
    </div>
    

    
    
    <div class="copyright">© Copyright 2020 to ∞. Try Catch Finally Solutions Ltd. All rights reserved.</div>
    
</div>


<script src="https://unpkg.com/medium-zoom@1.0.4/dist/medium-zoom.min.js"></script>
<script>
  mediumZoom(document.querySelectorAll('img'));
</script></body>

</html>